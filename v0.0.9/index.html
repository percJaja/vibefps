<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>FPS ê²Œì„ - Vibe Jam 2025</title>
  <link rel="stylesheet" href="css/style.css">
  <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¯¸ë¦¬ ë¡œë“œ -->
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js" as="script">
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/cannon.js/0.6.2/cannon.min.js" as="script">
  <style>
    /* í•„ìˆ˜ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ - ì¦‰ì‹œ í™”ë©´ì— í‘œì‹œí•  ìš”ì†Œì— ëŒ€í•œ ìŠ¤íƒ€ì¼ */
    body {
      margin: 0;
      overflow: hidden;
      font-family: 'system-ui', sans-serif;
      touch-action: none;
      background-color: #000;
    }
    
    #overlayTip {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 24px;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
      z-index: 1000;
      opacity: 0.8;
      pointer-events: none; /* í´ë¦­/í„°ì¹˜ë¥¼ í†µê³¼ì‹œí‚´ */
      transition: opacity 0.5s;
      animation: fadeInOut 3s forwards;
    }
    
    @keyframes fadeInOut {
      0% { opacity: 0; }
      20% { opacity: 1; }
      80% { opacity: 1; }
      100% { opacity: 0; }
    }
    
    /* ì‹œì‘ í™”ë©´ ìˆ¨ê¹€ */
    #startScreen {
      display: none;
    }
    
    #gameUI {
      opacity: 0;
      transition: opacity 1s;
    }
    
    #gameUI.visible {
      opacity: 1;
    }
  </style>
</head>
<body>
  <!-- í•„ìˆ˜ ì¡°ì‘ë²• íŒ (ì‚¬ë¼ì§) -->
  <div id="overlayTip">
    <p>WASDë¡œ ì´ë™, ë§ˆìš°ìŠ¤ë¡œ ì¡°ì¤€, í´ë¦­ìœ¼ë¡œ ë°œì‚¬</p>
    <p>ë¹¨ê°„ìƒ‰: ì¼ë°˜ (10ì ) | ê¸ˆìƒ‰: ë³´ë„ˆìŠ¤ (25ì ) | ë…¹ìƒ‰: í˜ë„í‹° (-15ì )</p>
  </div>

  <!-- ê²Œì„ ì‹œì‘ í™”ë©´ (ìˆ¨ê¹€) -->
  <div id="startScreen" class="screen">
      <h1>FPS ê²Œì„</h1>
      <p>WASDë¡œ ì´ë™, ë§ˆìš°ìŠ¤ë¡œ ì¡°ì¤€, í´ë¦­ìœ¼ë¡œ ë°œì‚¬</p>
      <p>ë¹¨ê°„ìƒ‰ íƒ€ê²Ÿ: ì¼ë°˜ (10ì ) | ê¸ˆìƒ‰ íƒ€ê²Ÿ: ë³´ë„ˆìŠ¤ (25ì ) | ë…¹ìƒ‰ íƒ€ê²Ÿ: í˜ë„í‹° (-15ì )</p>
      <p>ì—°ì† íƒ€ê²©ìœ¼ë¡œ ì½¤ë³´ ì ìˆ˜ë¥¼ ì–»ìœ¼ì„¸ìš”!</p>
      <button id="startButton" class="button">ê²Œì„ ì‹œì‘</button>
  </div>
  
  <div id="settingsScreen" class="screen">
      <h2>ì„¤ì •</h2>
      <div class="settings-grid">
          <div>ì•ìœ¼ë¡œ ì´ë™:</div>
          <div>
              <select id="forwardKey" class="keyBinding">
                  <option value="KeyW">W</option>
                  <option value="KeyS">S</option>
                  <option value="ArrowUp">â†‘</option>
              </select>
          </div>
          
          <div>ë’¤ë¡œ ì´ë™:</div>
          <div>
              <select id="backwardKey" class="keyBinding">
                  <option value="KeyS">S</option>
                  <option value="KeyW">W</option>
                  <option value="ArrowDown">â†“</option>
              </select>
          </div>
          
          <div>ì™¼ìª½ ì´ë™:</div>
          <div>
              <select id="leftKey" class="keyBinding">
                  <option value="KeyA">A</option>
                  <option value="KeyD">D</option>
                  <option value="ArrowLeft">â†</option>
              </select>
          </div>
          
          <div>ì˜¤ë¥¸ìª½ ì´ë™:</div>
          <div>
              <select id="rightKey" class="keyBinding">
                  <option value="KeyD">D</option>
                  <option value="KeyA">A</option>
                  <option value="ArrowRight">â†’</option>
              </select>
          </div>
          
          <div>ìŒì•… ë³¼ë¥¨:</div>
          <div>
              <input type="range" id="musicVolume" min="0" max="1" step="0.1" value="0.5">
          </div>
          
          <div>íš¨ê³¼ìŒ ë³¼ë¥¨:</div>
          <div>
              <input type="range" id="sfxVolume" min="0" max="1" step="0.1" value="0.7">
          </div>
      </div>
      <button id="saveSettings" class="button">ì €ì¥</button>
      <button id="cancelSettings" class="button">ì·¨ì†Œ</button>
  </div>
  
  <div id="gameOverScreen" class="screen" style="display: none;">
      <h1>ê²Œì„ ì¢…ë£Œ</h1>
      <p>ìµœì¢… ì ìˆ˜: <span id="finalScore">0</span></p>
      <button id="restartButton" class="button">ë‹¤ì‹œ ì‹œì‘</button>
  </div>
  
  <div id="gameUI">
      <div>ì ìˆ˜: <span id="score">0</span></div>
      <div>íƒ„ì•½: <span id="ammo">30</span> / <span id="maxAmmo">30</span></div>
      <div>ë‚¨ì€ ì‹œê°„: <span id="timer">60</span>ì´ˆ</div>
      <button id="settingsButton" class="settings-btn">âš™ï¸ ì„¤ì •</button>
  </div>
  
  <!-- ì½¤ë³´ ì¹´ìš´í„° -->
  <div id="combo" class="combo-counter">3x Combo (1.5x)</div>
  
  <div class="health-bar">
      <div class="health-fill" id="healthFill"></div>
  </div>
  
  <img id="crosshair" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGNpcmNsZSBjeD0iMTAiIGN5PSIxMCIgcj0iOCIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+CiAgPGNpcmNsZSBjeD0iMTAiIGN5PSIxMCIgcj0iMSIgZmlsbD0id2hpdGUiLz4KICA8bGluZSB4MT0iMTAiIHkxPSIzIiB4Mj0iMTAiIHkyPSI3IiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiLz4KICA8bGluZSB4MT0iMTAiIHkxPSIxMyIgeDI9IjEwIiB5Mj0iMTciIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMiIvPgogIDxsaW5lIHgxPSIzIiB5MT0iMTAiIHgyPSI3IiB5Mj0iMTAiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMiIvPgogIDxsaW5lIHgxPSIxMyIgeTE9IjEwIiB4Mj0iMTciIHkyPSIxMCIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIyIi8+Cjwvc3ZnPg==" alt="Crosshair">
  
  <div id="hitMarker">âœ•</div>
  <div id="gunEffects"></div>
  
  <div id="mobileControls">
      <div id="joystick">
          <div id="joystickKnob"></div>
      </div>
      <div id="shootButton">ë°œì‚¬</div>
  </div>
  
  <a target="_blank" href="https://jam.pieter.com" style="font-family: 'system-ui', sans-serif; position: fixed; bottom: -1px; right: -1px; padding: 7px; font-size: 14px; font-weight: bold; background: #fff; color: #000; text-decoration: none; z-index: 10000; border: 1px solid #fff; border-top-left-radius: 12px;">ğŸ•¹ï¸ Vibe Jam 2025</a>
  
  <!-- ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ - async ì†ì„± ì¶”ê°€í•˜ì—¬ ë³‘ë ¬ ë¡œë“œ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cannon.js/0.6.2/cannon.min.js"></script>
  
  <!-- ì¦‰ì‹œ ê²Œì„ ì‹œì‘ì„ ìœ„í•œ ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ -->
  <script>
    // ì¡°ì‘ë²• íŒ ì œì–´
    setTimeout(() => {
      const tip = document.getElementById('overlayTip');
      if (tip) {
        tip.style.opacity = '0';
        setTimeout(() => {
          tip.remove();
        }, 500);
      }
    }, 3000);

    // ê²Œì„ UI ì„œì„œíˆ ë‚˜íƒ€ë‚˜ê²Œ
    setTimeout(() => {
      document.getElementById('gameUI').classList.add('visible');
    }, 1000);
    
    // ëª¨ë“  ê²Œì„ ëª¨ë“ˆì´ ë¡œë“œë˜ë©´ ìë™ìœ¼ë¡œ ê²Œì„ ì‹œì‘
    function initializeAndStartGame() {
      // ê²Œì„ ëª¨ë“ˆ ë¡œë“œ
      const modules = [
        'js/GameSettings.js',
        'js/AudioManager.js',
        'js/InputManager.js',
        'js/Graphics.js',
        'js/Physics.js',
        'js/Environment.js',
        'js/ParticleSystem.js', // ì¶”ê°€ëœ íŒŒí‹°í´ ì‹œìŠ¤í…œ ëª¨ë“ˆ
        'js/TargetManager.js',
        'js/GitHubTarget.js', // ì¶”ê°€ëœ GitHub íƒ€ê²Ÿ ëª¨ë“ˆ
        'js/Game.js'
      ];
      
      let loadedCount = 0;
      
      // ê° ëª¨ë“ˆ ë¡œë“œ
      modules.forEach(src => {
        const script = document.createElement('script');
        script.src = src;
        script.async = false; // ê²Œì„ ëª¨ë“ˆì€ ìˆœì„œëŒ€ë¡œ ë¡œë“œë˜ì–´ì•¼ í•¨
        
        script.onload = () => {
          loadedCount++;
          if (loadedCount === modules.length) {
            console.log('ëª¨ë“  ê²Œì„ ëª¨ë“ˆ ë¡œë“œ ì™„ë£Œ');
            // ëª¨ë“  ëª¨ë“ˆì´ ë¡œë“œë˜ê³  1ì´ˆ í›„ ê²Œì„ ìë™ ì‹œì‘
            setTimeout(() => {
              if (typeof Game !== 'undefined' && Game.startGame) {
                // startGame í•¨ìˆ˜ë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ì—¬ ê²Œì„ ì‹œì‘
                document.getElementById('startScreen').style.display = 'none';
                Game.startGame();
              }
            }, 1000);
          }
        };
        
        document.body.appendChild(script);
      });
    }
    
    // í˜ì´ì§€ ë¡œë“œ ì¦‰ì‹œ ê²Œì„ ì´ˆê¸°í™” ë° ì‹œì‘
    initializeAndStartGame();
  </script>
</body>
</html>
